---
import { getCollection } from 'astro:content'

const tagsEntry = await getCollection('posts')
const hasConent = tagsEntry.filter((entry) => entry.data.tags.length > 0).flatMap((post) => post.data.tags || [])
const allTags = [...new Set(hasConent)]
const { showName = true } = Astro.props
---

<section class="tags">
  {showName && <a href="/tags">Tags</a>}
  <ul>
    {
      allTags.map((tag) => (
        <li>
          <a href={`/tags/${tag}`}>{tag}</a>
        </li>
      ))
    }
  </ul>
</section>

<style>
  .tags:not(:empty) {
    margin-bottom: 2rem;
  }

  .tags a {
    color: var(--text-primary);
    text-decoration: none;
  }

  a {
    color: var(--text-primary);
    display: block;
    text-decoration: none;
    transition: opacity 0.15s ease-out;
  }

  .tags a:hover {
    text-decoration: underline;
  }

  .tags ul {
    list-style: none;
    margin: 0;
    padding: 0;
    display: flex;
    flex-wrap: wrap;
    gap: 0.6rem;
    margin-top: 1rem;
  }

  .tags ul a {
    display: inline-block;
    padding: 0.4rem 0.9rem;
    font-size: 0.95rem;
    border-radius: 6px;
    text-decoration: none;
    color: var(--text-secondary);
  }

  .tags ul a:hover {
    text-decoration: underline;
  }

  @media (hover: hover) and (pointer: fine) {
    ul:hover a {
      opacity: 0.4;
    }

    ul:hover a:hover {
      opacity: 1;
    }
  }
</style>
